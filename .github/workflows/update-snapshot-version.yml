name: Update SNAPSHOT Version
on: 
  milestone:
    types: [created]

jobs:
  update-version:
    runs-on: ubuntu-latest
    
    steps:
      - name: checkout
        uses: actions/checkout@master
        
      - name: Update release SNAPSHOT version 
        run: |
          echo version=${{ github.event.milestone.title }}-SNAPSHOT > gradle.properties
          
      - name: Create Pull request
        id: cpr
        uses: peter-evans/create-pull-request@v2
        with:
          token:  ${{ secrets.GITHUB_TOKEN }}
          commit-message: "Bump project version to ${{ github.event.milestone.title }}-SNAPSHOT"
          title: 'Bump project version to ${{ github.event.milestone.title }}-SNAPSHOT'
          body: |
            - Auto-generated by [create-pull-request][1]
              
              [1]: https://github.com/peter-evans/create-pull-request
          labels: automated
          reviewers: rashidi
          milestone: ${{ github.event.milestone.title }}
          branch: snapshot-${{ github.event.milestone.title }}

      - name: Check outputs
        run: |
          echo "Pull Request Number - ${{ env.PULL_REQUEST_NUMBER }}"
          echo "Pull Request Number - ${{ steps.cpr.outputs.pull-request-number }}"
